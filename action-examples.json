{
    "version": "1.0",
    "description": "Exempel pÃ¥ msg.action/msg.group anvÃ¤ndning i Reflink OS",
    
    "controllersExamples": [
        {
            "action": "showControllers",
            "group": "Controllers",
            "description": "Visa alla regulatorer (kylar + frysar)",
            "triggerExample": {
                "type": "inject",
                "props": [
                    { "p": "action", "v": "showControllers", "vt": "str" },
                    { "p": "group", "v": "Controllers", "vt": "str" }
                ]
            },
            "expectedOutput": {
                "msg.controllers": "Array med alla regulatorer",
                "msg.payload": "Samma som msg.controllers",
                "msg.count": "Antal regulatorer"
            }
        },
        {
            "action": "showKylar",
            "group": "Kylar",
            "description": "Visa endast kylar (setpoint >= 0Â°C)",
            "filterLogic": "controller.setpoint >= 0"
        },
        {
            "action": "showFrysar",
            "group": "Frysar",
            "description": "Visa endast frysar (setpoint < 0Â°C)",
            "filterLogic": "controller.setpoint < 0"
        }
    ],
    
    "machinesExamples": [
        {
            "action": "showMachines",
            "group": "Machines",
            "description": "Visa alla maskiner med frekvens",
            "expectedOutput": {
                "msg.machines": "Array med maskiner inkl. freqHz property",
                "msg.payload": "Samma som msg.machines",
                "msg.count": "Antal maskiner"
            }
        },
        {
            "action": "showMachineGauges",
            "group": "Machines",
            "description": "Visa maskin-gauges",
            "note": "Returnerar array med 3 gauge-meddelanden fÃ¶r anslutning till ui-gauge"
        }
    ],
    
    "alarmsExamples": [
        {
            "action": "showAlarms",
            "group": "Alarms",
            "description": "Visa alla aktiva larm",
            "expectedOutput": {
                "msg.alarms": "Array med aktiva larm",
                "msg.alarmsSummary": "Objekt med total, critical, warning, info",
                "msg.count": "Antal aktiva larm"
            }
        },
        {
            "action": "showAlarmSummary",
            "group": "Alarms",
            "description": "Visa sammanfattning som text",
            "expectedOutput": {
                "msg.payload": "String: 'âœ… Inga aktiva larm' eller 'âš ï¸ X larm â€¢ Y kritiska...'"
            }
        },
        {
            "action": "latestAlarms",
            "group": "Alarms",
            "description": "Visa senaste 5 larm",
            "expectedOutput": {
                "msg.payload": "Array med senaste 5 larm sorterade pÃ¥ timestamp"
            }
        },
        {
            "action": "acknowledgeAlarm",
            "group": "Alarms",
            "description": "Kvittera ett larm",
            "requiredInput": {
                "msg.alarmId": "ID pÃ¥ larmet som ska kvitteras",
                "msg.acknowledgedBy": "Vem som kvitterade (optional, default 'OkÃ¤nd')"
            }
        }
    ],
    
    "nodesExamples": [
        {
            "action": "showNodes",
            "group": "Nodes",
            "description": "Visa alla konfigurerade noder/enheter",
            "expectedOutput": {
                "msg.nodes": "Array med alla noder frÃ¥n global.enheter",
                "msg.nodeCount": "Antal noder"
            }
        },
        {
            "action": "addNode",
            "group": "Nodes",
            "description": "LÃ¤gg till ny nod",
            "requiredInput": {
                "msg.payload.category": "Kylrum, Frysrum, Aggregat, etc.",
                "msg.payload.name": "Enhetsnamn",
                "msg.payload.brand": "Danfoss, Carrier, etc.",
                "msg.payload.model": "AK-CC55, etc.",
                "msg.payload.address": "Modbus-adress (number)"
            }
        }
    ],
    
    "systemExamples": [
        {
            "action": "refresh",
            "group": "System",
            "description": "Trigger fÃ¶r att uppdatera data",
            "note": "Generisk refresh-action som kan trigga omlÃ¤sning"
        },
        {
            "action": "initTestData",
            "group": "System",
            "description": "Initiera testdata vid startup",
            "note": "AnvÃ¤nds av inject-noder med once: true"
        }
    ],
    
    "bestPractices": [
        {
            "rule": "Alltid Safe Header fÃ¶rst",
            "example": "msg.action = msg.action || 'defaultAction';\nmsg.group = msg.group || 'DefaultGroup';"
        },
        {
            "rule": "AnvÃ¤nd fallback fÃ¶r global.get",
            "example": "const data = global.get('myData') || [];"
        },
        {
            "rule": "SÃ¤tt node.status fÃ¶r debugging",
            "example": "node.status({ fill: 'green', shape: 'dot', text: `${msg.action}: ${result.length} st` });"
        },
        {
            "rule": "Returnera alltid count",
            "example": "msg.count = result.length;"
        },
        {
            "rule": "Dubbla outputs (payload + typed property)",
            "example": "msg.controllers = result;\nmsg.payload = result;"
        }
    ],
    
    "antiPatterns": [
        {
            "problem": "Direkt Ã¥tkomst utan validering",
            "bad": "const value = msg.payload.someValue;",
            "good": "const value = (msg.payload && msg.payload.someValue) || 'default';"
        },
        {
            "problem": "Saknad action/group",
            "bad": "// Ingen Safe Header\nconst data = getData();",
            "good": "// ðŸ›¡ï¸ SAFE HEADER\nmsg.action = msg.action || 'getData';\nmsg.group = msg.group || 'Data';\nconst data = getData();"
        },
        {
            "problem": "HÃ¥rdkodade vÃ¤rden istÃ¤llet fÃ¶r msg properties",
            "bad": "msg.payload = 'showKylar';  // AnvÃ¤nd inte payload fÃ¶r action!",
            "good": "msg.action = 'showKylar';"
        }
    ]
}

